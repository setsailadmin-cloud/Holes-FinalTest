<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Holes - Final Test Classroom Review</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600;700&display=swap');
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #fdf5e6;
        }
        .desert-card {
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            border: 1px solid #d2691e;
            transition: all 0.3s ease;
        }
        .correct-bg { background-color: #f0fdf4; border-color: #22c55e !important; }
        .incorrect-bg { background-color: #fef2f2; border-color: #ef4444 !important; }
        .correct-text { color: #16a34a; font-weight: bold; }
        .incorrect-text { color: #dc2626; font-weight: bold; }
        
        .print-only { display: none; }
        .print-score-pill { display: none; }

        /* Print Styles */
        @media print {
            .no-print { display: none !important; }
            .print-only { display: block !important; }
            body { background-color: white !important; padding: 0 !important; }
            .desert-card { border: none !important; box-shadow: none !important; page-break-inside: avoid; margin-bottom: 20px !important; padding: 10px !important; }
            .sticky { position: static !important; border: none !important; border-top: 2px solid #000 !important; margin-top: 20px !important; }
            
            h1 { font-size: 24pt !important; color: black !important; margin-bottom: 5px !important; }
            h2 { font-size: 18pt !important; border-bottom: 1px solid #000 !important; color: black !important; margin-top: 20px !important; margin-bottom: 10px !important;}
            
            .print-score-pill { 
                display: inline-block !important; 
                float: right;
                font-weight: bold;
                border: 1px solid #000;
                padding: 2px 8px;
                border-radius: 4px;
                font-size: 10pt;
            }
            .question-text { font-size: 11pt !important; width: 85%; display: inline-block; }
            .mc-option-print { font-size: 10pt; margin-left: 20px; color: #444; }
            .mc-selected { font-weight: bold; text-decoration: underline; color: black; }
            .mc-correct { color: #16a34a !important; font-weight: bold; }
            
            #congrats-area { display: block !important; text-align: center; margin-top: 30px; font-size: 14pt; font-weight: bold; border: 2px dashed #000; padding: 15px; page-break-inside: avoid; }
            #print-header-info { display: block !important; margin-bottom: 20px; border-bottom: 1px solid #000; padding-bottom: 10px; }
            
            .teacher-key-box { margin-top: 5px; padding: 10px; border-left: 4px solid #d2691e; background: #fffcf0; font-size: 9pt; }
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-4xl mx-auto">
        <!-- Print Header -->
        <div id="print-header-info" class="hidden">
            <h1 class="text-3xl font-bold">Holes Final Achievement Report</h1>
            <div class="flex justify-between mt-4">
                <p><b>Student Name:</b> ___________________________</p>
                <p><b>Review Date:</b> <span id="current-date"></span></p>
            </div>
        </div>

        <!-- On-Screen Header -->
        <div class="text-center mb-10 no-print">
            <h1 class="text-4xl font-bold text-orange-800 mb-2">ðŸ“– Holes Final Test Review</h1>
            <p class="text-orange-600 italic">Live Classroom Review Mode â€¢ Immediate Feedback</p>
        </div>

        <div id="test-container" class="space-y-8">
            
            <!-- Part A -->
            <section id="section-a" class="desert-card p-6">
                <h2 class="text-2xl font-bold text-orange-900 border-b-2 border-orange-200 pb-2 mb-4">Part A: Character Matching</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 p-4 bg-orange-50 rounded-lg text-sm border border-orange-200 no-print">
                    <div><b>a.</b> Stanley | <b>b.</b> Zero | <b>c.</b> Warden | <b>d.</b> Mr. Sir | <b>e.</b> Pendanski</div>
                    <div><b>f.</b> Sam | <b>g.</b> Kate Barlow | <b>h.</b> X-Ray | <b>i.</b> Magnet | <b>j.</b> Elya</div>
                </div>

                <div id="part-a-questions" class="space-y-4"></div>
            </section>

            <!-- Part B -->
            <section id="section-b" class="desert-card p-6">
                <h2 class="text-2xl font-bold text-orange-900 border-b-2 border-orange-200 pb-2 mb-4">Part B: Multiple Choice</h2>
                <div id="part-b-questions" class="space-y-6"></div>
            </section>

            <!-- Part C -->
            <section id="section-c" class="desert-card p-6">
                <h2 class="text-2xl font-bold text-orange-900 border-b-2 border-orange-200 pb-2 mb-4">Part C: Short Answer Discussion</h2>
                <div id="part-c-questions" class="space-y-8"></div>
            </section>

            <!-- Congrats Message (Visible in Print & Result) -->
            <div id="congrats-area" class="hidden">
                <p id="congrats-msg" class="text-orange-800"></p>
            </div>

            <!-- Final Score Footer -->
            <div class="sticky bottom-4 desert-card p-4 flex flex-col md:flex-row justify-between items-center border-2 border-orange-500 shadow-xl z-40 bg-white gap-4">
                <div class="flex items-center gap-4">
                    <div class="text-2xl font-black text-orange-700">
                        Final Performance: <span id="live-score">0</span> / 100 
                        <span id="percent-display" class="ml-2 text-xl text-orange-500">(0%)</span>
                    </div>
                </div>
                
                <button onclick="handlePrint()" class="no-print bg-orange-700 hover:bg-orange-800 text-white font-bold py-2 px-6 rounded-lg shadow-md flex items-center gap-2 transition-transform active:scale-95">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
                    </svg>
                    Print Detailed Report
                </button>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('current-date').innerText = new Date().toLocaleDateString();

        const partAAnswers = ["e", "j", "f", "i", "g", "c", "h", "a", "d", "b"];
        const partAQuotes = [
            "Iâ€™m not a girl; Iâ€™m a counselor who believes that even the most 'worthless' person has a talent.",
            "I forgot to carry a certain lady up a mountain, and it cost my family their luck for over a century.",
            "I can fix that.",
            "My fingers are like little magnets; I can't help what sticks to them.",
            "One day I was a schoolteacher; the next I was an outlaw with a signature kiss and a buried treasure.",
            "I've spent my whole life digging for my family's lost inheritance, and I won't let some lawyers stop me now.",
            "If you find something interesting, you give it to me first, because Iâ€™ve been here the longest and I'm the leader.",
            "I carried my best friend up a mountain when he was too weak to walk, and I finally broke the family curse.",
            "This isnâ€™t a Girl Scout camp. You dig to build character, but mostly you dig because I told you to.",
            "Iâ€™m not actually 'Zero'; Iâ€™m a math genius who survived on 110-year-old 'Sploosh' in the desert."
        ];

        const partBQuestions = [
            { q: "Stanley was sent to Camp Green Lake because he was accused of stealing sneakers.", options: ["A gold lipstick tube", "Clyde Livingston's shoes", "A stash of jewelry", "Sunseeds"], ans: 1 },
            { q: "The Warden has the boys digging holes to find Kate Barlowâ€™s buried treasure.", options: ["Water sources", "Lost dinosaur bones", "Kate Barlow's treasure", "The Warden's ancestors"], ans: 2 },
            { q: "The initials 'KB' on the gold tube found by Stanley stand for Katherine Barlow.", options: ["King of Books", "Katherine Barlow", "Keep Back", "Knowledge is Best"], ans: 1 },
            { q: "Deadly lizards don't bite the boys because of their onion-tainted blood.", options: ["They were sleeping", "The boys were motionless", "The boys ate raw onions", "The lizards were tame"], ans: 2 },
            { q: "The liquid 'Sploosh' discovered by Zero is 110-year-old preserved peaches.", options: ["Muddy river water", "A chemical spill", "Spiced preserved peaches", "Old grape juice"], ans: 2 },
            { q: "God's Thumb is where Stanleyâ€™s great-grandfather survived a desert abandonment.", options: ["True", "False", "Partially True", "Unknown"], ans: 0 },
            { q: "Zeroâ€™s real last name (Zeroni) proves his family connection to Madame Zeroni.", options: ["He is a Yelnats", "He is a Zeroni descendant", "He is the Warden's son", "He is a Walker"], ans: 1 },
            { q: "After Sam was killed, it never rained again in Green Lake for over a century.", options: ["True", "False", "It rained once", "It flooded"], ans: 0 },
            { q: "The curse is broken when Stanley carries Zero up the mountain and sings to him.", options: ["He finds gold", "He carries the Zeroni descendant", "He kills the Warden", "He leaves the camp"], ans: 1 },
            { q: "The Warden is a descendant of which historical figure?", options: ["Kate Barlow", "Sam the Onion Man", "Trout Walker", "Madame Zeroni"], ans: 2 },
            { q: "Why did Zero hit Mr. Pendanski with a shovel?", options: ["To steal the truck", "He was called 'nothing'", "It was an accident", "To save Stanley"], ans: 1 },
            { q: "How does Stanleyâ€™s father finally become successful?", options: ["He found the gold", "He invented a foot odor cure", "He won the lottery", "He became a lawyer"], ans: 1 },
            { q: "What name was written on the suitcase found in the hole?", options: ["Kate Barlow", "Stanley Yelnats", "The Warden", "Mary Lou"], ans: 1 },
            { q: "At the end, Camp Green Lake is turned into what?", options: ["A prison", "A Girl Scout camp", "A museum", "A housing complex"], ans: 1 },
            { q: "The historical flashbacks are an example of what literary device?", options: ["Simile", "Metaphor", "Digression/Flashback", "Personification"], ans: 2 }
        ];

        const partCQuestions = [
            { q: "Explain the irony of the 'Sploosh' name.", key: "The name links Sam's boat (past) to Zero's survival (present) and the foot odor cure (future). It's ironic that old peaches saved a life and now a peach-scented spray saves feet." },
            { q: "How is Stanley a 'dynamic character'?", key: "Stanley transforms from a shy, unlucky, overweight boy who blames a curse to a strong, confident, and selfless person who takes charge of his own destiny." },
            { q: "What role did 'fate' play in Stanley and Zero meeting?", key: "Their ancestors' destinies were tied to a broken promise 110 years ago. Fate used the stolen shoes to bring the two descendants together to fix the past." },
            { q: "Why was it important that Stanley refused to leave without Zero?", key: "It proves he is no longer just a 'camper' but a friend. He realizes the Warden erased Zero's records and stays to ensure Zero isn't left to disappear." },
            { q: "How do Samâ€™s onions connect the history to Stanleyâ€™s survival?", key: "Sam's onions were miracle cures. In the present, they provided sustenance on the mountain and made the boys' blood unappealing to the deadly lizards." }
        ];

        let state = { a: Array(10).fill(0), b: Array(15).fill(null), c: Array(5).fill(0) };

        function updateLiveScore() {
            let scoreA = state.a.reduce((a,b)=>a+b, 0);
            let scoreB = state.b.reduce((acc, val, i) => acc + (val === partBQuestions[i].ans ? 3 : 0), 0);
            let scoreC = state.c.reduce((a,b)=>a+b, 0);
            
            let total = scoreA + scoreB + scoreC;
            document.getElementById('live-score').innerText = total;
            document.getElementById('percent-display').innerText = `(${total}%)`;
            
            let msg = "Keep digging! Every story has a connection.";
            if (total >= 90) msg = "ðŸ† OUTSTANDING! You've broken the curse and discovered the real treasure!";
            else if (total >= 75) msg = "ðŸŒŸ GREAT JOB! You've connected the past and present perfectly.";
            else if (total >= 50) msg = "ðŸ‘ GOOD WORK! You're finding your way through the desert.";
            
            document.getElementById('congrats-msg').innerText = msg;
            document.getElementById('congrats-area').classList.remove('hidden');
        }

        // Init Part A
        const partAContainer = document.getElementById('part-a-questions');
        partAQuotes.forEach((quote, i) => {
            const div = document.createElement('div');
            div.className = "p-4 border rounded-lg bg-gray-50 flex justify-between items-center q-row";
            div.innerHTML = `
                <div class="flex-1">
                    <span class="font-bold text-orange-800 mr-2">${i+1}.</span>
                    <span class="question-text">${quote}</span>
                    <div class="mt-2 no-print flex items-center gap-2">
                        <select onchange="handleA(${i}, this.value, this)" class="border-2 border-orange-300 rounded p-1 text-xs bg-white">
                            <option value="">Select Character...</option>
                            ${"abcdefghij".split('').map(l => `<option value="${l}">${l}</option>`).join('')}
                        </select>
                        <span id="fb-a-${i}" class="text-xs font-bold"></span>
                    </div>
                    <div class="print-only text-xs mt-1 text-gray-500 italic" id="print-ans-a-${i}">Match: </div>
                </div>
                <div id="print-pts-a-${i}" class="print-score-pill">Points: 0 / 3</div>
            `;
            partAContainer.appendChild(div);
        });

        function handleA(i, val, el) {
            const isCorrect = val === partAAnswers[i];
            state.a[i] = isCorrect ? 3 : 0;
            const container = el.closest('.q-row');
            container.className = `p-4 border rounded-lg flex justify-between items-center q-row ${isCorrect ? 'correct-bg' : val ? 'incorrect-bg' : 'bg-gray-50'}`;
            document.getElementById(`print-pts-a-${i}`).innerText = `Points: ${state.a[i]} / 3`;
            document.getElementById(`print-ans-a-${i}`).innerText = `Matched Character: ${val ? val.toUpperCase() : 'None'} (${isCorrect ? 'Correct' : 'Incorrect'})`;
            updateLiveScore();
        }

        // Init Part B
        const partBContainer = document.getElementById('part-b-questions');
        partBQuestions.forEach((item, i) => {
            const div = document.createElement('div');
            div.className = "p-4 border rounded-lg bg-gray-50 flex flex-col q-row";
            div.innerHTML = `
                <div class="flex justify-between items-start">
                    <div class="flex-1">
                        <span class="font-bold text-orange-800 mr-2">${i+1}.</span>
                        <span class="question-text font-medium">${item.q}</span>
                    </div>
                    <div id="print-pts-b-${i}" class="print-score-pill">Points: 0 / 3</div>
                </div>
                
                <div class="mt-4 space-y-2 no-print">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                        ${item.options.map((opt, optIdx) => `
                            <button onclick="handleB(${i}, ${optIdx}, this)" 
                                    class="mc-btn text-left p-2 border rounded bg-white text-xs hover:bg-orange-50 transition-colors">
                                ${String.fromCharCode(65 + optIdx)}. ${opt}
                            </button>
                        `).join('')}
                    </div>
                </div>

                <div class="print-only mt-2 space-y-1">
                    ${item.options.map((opt, optIdx) => `
                        <div class="mc-option-print" id="print-opt-b-${i}-${optIdx}">
                            ${String.fromCharCode(65 + optIdx)}. ${opt}
                        </div>
                    `).join('')}
                </div>
            `;
            partBContainer.appendChild(div);
        });

        function handleB(i, optIdx, el) {
            const correct = partBQuestions[i].ans;
            state.b[i] = optIdx;
            const container = el.closest('.q-row');
            const isCorrect = optIdx === correct;
            
            container.className = `p-4 border rounded-lg flex flex-col q-row ${isCorrect ? 'correct-bg' : 'incorrect-bg'}`;
            
            const buttons = container.querySelectorAll('.mc-btn');
            buttons.forEach((btn, idx) => {
                btn.className = "mc-btn text-left p-2 border rounded text-xs transition-colors " + 
                    (idx === optIdx ? (isCorrect ? "bg-green-500 text-white font-bold" : "bg-red-500 text-white font-bold") : "bg-white");
            });

            for(let j=0; j<4; j++){
                const pOpt = document.getElementById(`print-opt-b-${i}-${j}`);
                pOpt.className = "mc-option-print";
                if(j === optIdx) pOpt.classList.add('mc-selected');
                if(j === correct) pOpt.classList.add('mc-correct');
            }
            
            document.getElementById(`print-pts-b-${i}`).innerText = `Points: ${isCorrect ? 3 : 0} / 3`;
            updateLiveScore();
        }

        // Init Part C
        const partCContainer = document.getElementById('part-c-questions');
        partCQuestions.forEach((item, i) => {
            const div = document.createElement('div');
            div.className = "p-4 border rounded-lg bg-gray-50 q-row";
            div.innerHTML = `
                <div class="flex justify-between items-start">
                    <div class="flex-1">
                        <p class="font-bold text-gray-800 mb-2">${i+1}. ${item.q}</p>
                    </div>
                    <div id="print-pts-c-${i}" class="print-score-pill">Points: 0 / 5</div>
                </div>
                
                <div class="no-print space-y-2">
                    <div class="flex gap-2 items-center mt-2">
                        <span class="text-xs font-bold text-gray-500 uppercase">Grade:</span>
                        ${[0, 2, 4, 5].map(p => `<button onclick="handleC(${i}, ${p}, this)" class="px-4 py-1 border rounded bg-white text-xs font-bold hover:border-orange-500">${p} Pts</button>`).join('')}
                        <button onclick="this.parentElement.nextElementSibling.classList.toggle('hidden')" class="ml-auto text-xs text-orange-600 font-bold underline">Show Key</button>
                    </div>
                    <div class="hidden p-3 bg-white border border-dashed border-orange-300 rounded text-xs italic text-gray-600">
                        <strong>Teacher's Key:</strong> ${item.key}
                    </div>
                </div>

                <div class="print-only">
                    <div class="teacher-key-box"><strong>Teacher's Key:</strong> ${item.key}</div>
                </div>
            `;
            partCContainer.appendChild(div);
        });

        function handleC(i, p, el) {
            state.c[i] = p;
            const container = el.closest('.q-row');
            container.className = `p-4 border rounded-lg q-row ${p === 5 ? 'correct-bg' : p > 0 ? 'bg-orange-50' : 'bg-gray-50'}`;
            
            const btns = el.parentElement.querySelectorAll('button');
            btns.forEach(b => b.classList.remove('bg-orange-600', 'text-white'));
            if(p !== null) el.classList.add('bg-orange-600', 'text-white');
            
            document.getElementById(`print-pts-c-${i}`).innerText = `Points: ${p} / 5`;
            updateLiveScore();
        }

        function handlePrint() {
            window.print();
        }
    </script>
</body>
</html>
